#  												[大合奏]使用教程

​														![1570334206913](http://static.zhi-yun.cn/2019/10/1570334206913.png)

-----

## 0.免责声明

![1570334064740](http://static.zhi-yun.cn/2019/10/1570334064740.png)

## 1.界面说明

​		![1570336113284](http://static.zhi-yun.cn/2019/10/1570336113284.png)			

## 2.初期设置

​	**第一次使用时请务必进行键位设置。**![1570334404062](http://static.zhi-yun.cn/2019/10/1570334404062.png) 

1. 根据游戏中的键位布局选择8键或者22键（即全音阶显示）

2. 点击高亮的按钮，打开键位配置界面

   ![1570334493453](http://static.zhi-yun.cn/2019/10/1570334493453.png)

3. 在输入框中直接按下与**游戏演奏UI相同**的按键

   > **请注意：**游戏中无法绑定的按键即便在大合奏中可以绑定，也无法在游戏中正常演奏。比如小键盘的数字等。 

4. 也可以选择导入其他玩家或者前一版本的按键配置，导入后确认界面显示无误后，点击应用退出绑定界面。

## 3.自动演奏

>[大合奏!]使用midi文件作为自动演奏用的输入。由于游戏机能限制，不是每个从midishow或者其他什么乱七八糟网站下载的midi都可以很好地演奏。

1. 点击导入按钮，打开midi文件

   ![1570337177267](http://static.zhi-yun.cn/2019/10/1570337177267.png)

2. 选择相应的轨道

   ![1570337202215](http://static.zhi-yun.cn/2019/10/1570337202215.png)

3. 如有必要，进行相应的速度和音高调整

4. 进入游戏，在演奏界面按下**Ctrl+F10**开始演奏

5. 如需要中途停止，按下**Ctrl+F11**即可

## 4.Midi键盘演奏

​	![1570337330274](http://static.zhi-yun.cn/2019/10/1570337330274.png)

1. 将midi键盘通过usb连接到电脑上，在键盘选择的下拉项中找到自己的midi设备

2. 点击开始连接，当提示连接成功后即可在游戏中使用midi键盘进行演奏。

   ​	![1570337599657](http://static.zhi-yun.cn/2019/10/1570337599657.png)

## 5.合奏

> 目前的合奏是建立在自动演奏的基础上，因此请先参考自动演奏部分进行midi的导入和音轨选择等配置。

1. 与合奏的队友们约定好同步演奏的时间，点击**网络同步**

   > 2.3.3.3版本中演奏时间输入框支持复制和粘贴，可以由队友们的一人粘贴后其他人进行复制，确保时间同步。

   ![1570338723833](http://static.zhi-yun.cn/2019/10/1570338723833.png)

2. 正常情况下，软件会自动同步本地时间。**开启抓包**按钮变为**停止抓包**

3. 如果有玩家延迟较高，可以通过将**网络延迟**设为负值进行补正。

4. 完成设置的玩家们点击**准备好了**按钮，返回游戏等待同步演奏即可。

5. 演奏中如需中断同样按下**Ctrl+F11**即可。

## 6.高级合奏功能

> 请注意：此功能正在付费内部测试中，在测试稳定后会进行公开发布，如果您是合奏的组织者想参与测试请加群或联系QQ：shiro#ffxiv.cat

1. 当您加入内部测试计划后，点击**网络同步**后，软件的标题栏会出现"Beta版"的字样。

   ![1577027225477](http://static.zhi-yun.cn/2019/10/1577027225477.png)

2. Beta模式下，当接收到**战斗倒计时**信号后，会自动设置演奏时间并进行演奏准备。即**战斗倒计时**结束后，所有开启软件的小队成员会同时开始演奏。

   同时，在左下角的状态栏和悬浮窗均会显示开启战斗倒计时的玩家及倒计时时间。

   ![1577027384893](http://static.zhi-yun.cn/2019/10/1577027384893.png)

   ![1577027501239](http://static.zhi-yun.cn/2019/10/1577027501239.png)

3. Beta模式下，当接收到**准备确认**信号或者**场景标记**信号后，会自动停止当前的演奏。等同于按下停止快捷键。

   > 目前的简单测试中，准备确认信号的识别率较低，我们推荐使用场景标记来进行停止，包括建立标记和撤销标记均可以触发。

4. 在Beta模式下，原本的抓包同步功能仍然有效。

## 7.悬浮窗

> 请注意：此功能为测试功能，会存在不稳定的现象。

1. 悬浮窗依赖于部分外部库，这部分库默认不提供下载，请加群后下载参与测试，当测试稳定后会公开下载地址。

2. 下载外部库后，点击状态栏的最后一个图标即可打开悬浮窗![1577027738216](http://static.zhi-yun.cn/2019/10/1577027738216.png)

3. 当前版本悬浮窗功能仅作为进度显示及Log信息输出使用

4. 当开始演奏后，进度条会实时显示演奏百分比。

   ![1577027894151](http://static.zhi-yun.cn/2019/10/1577027894151.png)

5. 点击进度条可以隐藏或开启Log信息。

   ![1577027908462](http://static.zhi-yun.cn/2019/10/1577027908462.png)

## 8.高级设置及快捷键绑定



​	![1577027955309](http://static.zhi-yun.cn/2019/10/1577027955309.png)

1. 点击主界面状态栏的齿轮按钮即可打开高级设置界面。设置界面分为播放设置及快捷键绑定两个部分。

2. 高级播放设置简单说明

   - **两音符最小间隔：**

     ​	解析后的两个按键操作的最小间隔，同时作用于Midi键盘的连接及自动演奏。

     ​	参数调小可以增加Midi演奏的流畅度，但过小会导致吃音。

   - **和弦解析最小间隔**：

     ​	解析到和弦时两个音符的最小间隔

     ​	参数调小会使琶音速度变快，但是演奏效果可能会下降。

   - **等比例琶音**：

     ​	实验功能，可以自行开启体验。

   - **NTP服务器：**

     ​	当时间同步异常的时候用于更换服务器地址。常见的公共服务器如下：

     	- **国家授时中心 NTP 服务器** ntp.ntsc.ac.cn
     	- **阿里云公共 NTP 服务器** time.pool.aliyun.com
     	- **腾讯云公共 NTP 服务器** time1.cloud.tencent.com
     	- **国际 NTP 快速授时服务** pool.ntp.org
     	- **微软 Windows NTP 服务器** time.windows.com

     

3. 快捷键绑定说明

   	- 在输入框中直接按下快捷键即可
   - 快捷键不限制必须使用Ctrl/Alt，不过设成了F10肯定会有冲突的吧
   - 如果快捷键已经被绑定，则输入无效
   - 点击输入框右侧的图标可以清空快捷键，未分配的快捷键处于无效状态
   - 向上移调/向下移调一次为1个半音



## 常见问题

### 1.软件界面问题

​	在高分辨率下系统缩放会导致软件界面错乱，此时请在软件exe右键-属性-兼容性-更改高dpi设置，取消勾选所有高DPI缩放替代选项。

​	![1570339474373](http://static.zhi-yun.cn/2019/10/1570339474373.png)

![1570340396897](http://static.zhi-yun.cn/2019/10/1570340396897.png)



### 2.midi播放问题

​	由于游戏音域限制，超出音域的音无法演奏，表现像为“吃音”，实际上软件并无问题。

### 3.合奏延迟问题

​	在5.1之前的版本中，由于演奏数据包是由服务器进行转发，因此每位演奏者听到的演奏音均为他人至少500ms前的数据。表现为自己的演奏听起来比其他人快。此时应当寻找第三方进行判别。



## 更新履历

### 2.5.2.5 (2019/12/22)

1. 增加了暂停功能及其快捷键
2. 增加了本地双开(β)功能
3. 增加了网络控制(β)功能-使用游戏内指令直接控制每位玩家的演奏
4. 增加了悬浮窗(β)功能
5. 修正了在旧版本Win10下快捷键绑定功能的Bug
6. 修正了演奏结束时会卡键位的问题
7. 修正了设置值的上限

### 2.3.3.3 (2019/11/10)

1. 抓包合奏功能适配到5.0客户端
2. 增加了部分合奏辅助功能
3. 增加了快捷键修改功能
4. 修正了8键模式下与reshade冲突的问题
5. 修正了变速的解析方法，现在所有轨道都能识别出变速信息了
6. 修正了含有大量和弦时的解析性能问题

### 2.2.0.0 (2019/10/6)

1. 抓包合奏功能优化
2. midi键盘连接功能优化
3. 增加了读取轨道名的机能
4. 增加了播放时间的显示
5. 增加了后台演奏功能
6. 增加了键位导入导出功能

### 2.1.0.0 (2019/9/30)

1. 优化了和弦处理的逻辑
2. 针对变速曲完善了相应处理
3. 增加了抓包合奏功能
4. 优化了midi键盘按键采集，减少吃音现象
5. 更新服务器转移到中国大陆，避免github被墙

### 2.0.1.9 (2019/04/01)

1. 合奏功能α开放，并且追加了时间同步功能
2. 完全重写了Midi解析部分，演奏会更加流畅
3. 追加了Midi的试听功能
4. 修复了8键下的部分bug
5. 界面微调，预留网络合奏用接口

### 2.0.1.2 (2018/10/22)

1. 修复了BPM过高或过低导致软件崩溃的Bug
2. 修复了读取Midi文件的错误处理，读取到错误的Midi文件时也可以正常处理了
3. 修复了快捷键重复注册时无法退出的Bug
4. 修改了自动更新的一个逻辑

### 2.0.1.1 (2018/10/10)

1. 功能追加
   -和弦分解（beta）
   -自动读取起始BPM并忽略掉Format1的速度轨
   -版本更新检测
2. 逻辑修正
   -修正了演奏算法，现在会更加流畅
   -针对部分错误追加了提示
   -修正了部分Midi文件读取失败的错误
   -修正了部分Midi键盘无法读取NoteOff的问题